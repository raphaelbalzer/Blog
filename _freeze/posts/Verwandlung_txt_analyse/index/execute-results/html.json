{
  "hash": "7d9d6b1dbbaf5d49f1a60d7728a59e40",
  "result": {
    "markdown": "---\ntitle: \"Miniprojekt DS\"\nauthor: \"Raphael Balzer\"\ndate: \"2023-10-25\"\noutput:\n  html_document:\n    toc: true\n    df_print: paged\n    theme: minty\nimage: \"kaefer.png\"\n---\n\n\n# Textanalyse von Kafkas \"Die Verwandlung\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tokenizers)\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(ggthemes)\nlibrary(topicmodels)\nlibrary(tm)\n```\n:::\n\n\n## Datenimport\n\nZunächst wird der Text importiert.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung <- read.delim2(\"Die_Verwandlung.txt\")\nVerwandlung <- as_tibble(Verwandlung)\nVerwandlung <- Verwandlung[-c(1:24, 1812:2113), ]\nVerwandlung\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,787 × 1\n   The.Project.Gutenberg.eBook.of.Die.Verwandlung                          \n   <chr>                                                                   \n 1 I.                                                                      \n 2 Als Gregor Samsa eines Morgens aus unruhigen Träumen erwachte, fand er  \n 3 sich in seinem Bett zu einem ungeheueren Ungeziefer verwandelt. Er lag  \n 4 auf seinem panzerartig harten Rücken und sah, wenn er den Kopf ein wenig\n 5 hob, seinen gewölbten, braunen, von bogenförmigen Versteifungen         \n 6 geteilten Bauch, auf dessen Höhe sich die Bettdecke, zum gänzlichen     \n 7 Niedergleiten bereit, kaum noch erhalten konnte. Seine vielen, im       \n 8 Vergleich zu seinem sonstigen Umfang kläglich dünnen Beine flimmerten   \n 9 ihm hilflos vor den Augen.                                              \n10 »Was ist mit mir geschehen?« dachte er. Es war kein Traum. Sein Zimmer, \n# ℹ 1,777 more rows\n```\n:::\n:::\n\n\n### Tokenisierung\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_token <- Verwandlung %>% \n  unnest_tokens(output = token, input = The.Project.Gutenberg.eBook.of.Die.Verwandlung) %>% \n  filter(str_detect(token, \"[a-z]\"))\nVerwandlung_token\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 19,151 × 1\n   token    \n   <chr>    \n 1 i        \n 2 als      \n 3 gregor   \n 4 samsa    \n 5 eines    \n 6 morgens  \n 7 aus      \n 8 unruhigen\n 9 träumen  \n10 erwachte \n# ℹ 19,141 more rows\n```\n:::\n:::\n\n\n### Entfernen der Stop-Words\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(stopwords_de, package = \"lsa\")\n\nstopwords_de <- tibble(word = stopwords_de)\n\nstopwords_de <- stopwords_de %>% \n  rename(token = word)  \n\nVerwandlung_token <- Verwandlung_token %>% \n  anti_join(stopwords_de)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(token)`\n```\n:::\n\n```{.r .cell-code}\nVerwandlung_token %>% \n  count(token, sort = TRUE) %>% \n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,506 × 2\n   token         n\n   <chr>     <int>\n 1 er          444\n 2 gregor      218\n 3 schwester   107\n 4 schon        95\n 5 ihn          91\n 6 mutter       91\n 7 vater        91\n 8 nun          79\n 9 denn         68\n10 zimmer       67\n# ℹ 3,496 more rows\n```\n:::\n:::\n\n\n## Sentimentanalyse\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(sentiws, package = \"pradadata\")\nVerwandlung_senti <- Verwandlung_token %>% \n  inner_join(sentiws, by = c(\"token\" = \"word\")) %>% \n  select(-inflections)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in inner_join(., sentiws, by = c(token = \"word\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 174 of `x` matches multiple rows in `y`.\nℹ Row 3110 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n:::\n\n```{.r .cell-code}\nVerwandlung_senti\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 539 × 3\n   token          neg_pos   value\n   <chr>          <chr>     <dbl>\n 1 bereit         pos      0.004 \n 2 erhalten       pos      0.004 \n 3 hilflos        neg     -0.483 \n 4 ruhig          pos      0.382 \n 5 aufrecht       pos      0.004 \n 6 aufschlagen    neg     -0.04  \n 7 melancholisch  neg     -0.0048\n 8 undurchführbar neg     -0.0048\n 9 sorgen         neg     -0.0048\n10 sorgen         pos      0.223 \n# ℹ 529 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_senti %>%\n  count(token, neg_pos, sort = TRUE) %>%\n  ungroup() %>%\n  group_by(neg_pos) %>%\n  slice_max(n, n = 10)%>%\n  ungroup() %>%\n  mutate(token = reorder(token, n)) %>%\n  ggplot(aes(n, token, fill = neg_pos)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~neg_pos, scales = \"free_y\") +\n  labs(x = \"Häufigkeit\",\n       y = \"Wort\") +\n  theme_minimal() +\n  scale_fill_tableau(palette = \"Nuriel Stone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_senti %>% \n  group_by(neg_pos) %>% \n  summarise(polarity_sum = sum(value),\n            polarity_count = n()) %>% \n  mutate(polarity_prop = (polarity_count / sum(polarity_count)) %>% \n           round(2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 4\n  neg_pos polarity_sum polarity_count polarity_prop\n  <chr>          <dbl>          <int>         <dbl>\n1 neg            -52.7            241          0.45\n2 pos             37.2            298          0.55\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_senti %>% \n  distinct(token, .keep_all = TRUE) %>% \n  mutate(value_abs = abs(value)) %>%\n  group_by(neg_pos) %>%\n  top_n(10, value_abs) %>%\n  mutate(token = reorder(token, value_abs)) %>%\n  ggplot(aes(value_abs, token, fill = neg_pos)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~neg_pos, scales = \"free_y\") +\n  labs(x = \"Effektstärke\",\n       y = \"Wort\") +\n  theme_minimal() +\n  scale_fill_tableau(palette = \"Nuriel Stone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## n-gram - Analyse\n\nHäufigkeiten der Bigramme\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_bigram <- \n  Verwandlung %>%\n  unnest_tokens(bigram, The.Project.Gutenberg.eBook.of.Die.Verwandlung, token = \"ngrams\", n = 2) %>%\n  filter(!is.na(bigram))\n\n\nVerwandlung_bigram %>% \ncount(bigram, sort = TRUE) %>% \n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12,866 × 2\n   bigram            n\n   <chr>         <int>\n 1 die schwester    66\n 2 der vater        53\n 3 die mutter       52\n 4 in der           49\n 5 er sich          44\n 6 daß er           38\n 7 und die          36\n 8 die tür          32\n 9 mit dem          29\n10 auf dem          27\n# ℹ 12,856 more rows\n```\n:::\n:::\n\n\n### Ohne Stopwords\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerw_bigra_sep <- Verwandlung_bigram %>%\n  separate(bigram, c(\"word1\", \"word2\"), sep = \" \")%>%\n  filter(!word1 %in% stop_words$word) %>%\n  filter(!word2 %in% stop_words$word)\n\nVerw_bigra_sep %>%\n  unite(bigram, word1, word2, sep = \" \") %>%\n  count(bigram, sort = TRUE) %>%\n  slice_max(n, n = 10)%>%\n  mutate(bigram = reorder(bigram, n)) %>%\n  ggplot(aes(n, bigram)) +\n  geom_col(fill = \"#8175aa\") +\n  labs(x = \"Häufigkeit\",\n       y = \"Bigram\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### Beitrag von Verneinungen zu Sentimenten\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerneinungen <- c(\"nicht\", \"nie\", \"niemals\", \"keine\", \"kein\")\n\nVerw_bigra_sep %>%\n  filter(word1 %in% Verneinungen) %>%\n  inner_join(sentiws, by = c(word2 = \"word\")) %>%\n  count(word1, word2, value, sort = TRUE) %>% \n  mutate(Beitrag = n * value) %>%\n  arrange(desc(abs(Beitrag))) %>%\n  head(20) %>%\n  mutate(word2 = reorder(word2, Beitrag)) %>%\n  ggplot(aes(n * value, word2, fill = n * value > 0)) +\n  geom_col(show.legend = FALSE) +\n  labs(x = \"Sentiment-Wert * Häufigkeit\",\n       y = \"Verneinungen\") +\n  theme_minimal()+\n  scale_fill_tableau(\"Nuriel Stone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Themenanalyse\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_dtm <- DocumentTermMatrix(Verwandlung_token)\nVerwandlung_lda <- LDA(Verwandlung_dtm, k = 4, control = list(seed = 42))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVerwandlung_themen <- tidy(Verwandlung_lda, matrix = \"beta\")\n\nVerwandlung_themen <- Verwandlung_themen %>%\n  group_by(topic) %>%\n  slice_max(beta, n = 10) %>% \n  ungroup() %>%\n  arrange(topic, -beta)\n\nVerwandlung_themen %>%\n  mutate(term = reorder_within(term, beta, topic)) %>%\n  ggplot(aes(beta, term, fill = factor(topic))) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ topic, scales = \"free\") +\n  scale_y_reordered() +\n  theme_minimal() +\n  scale_fill_tableau(\"Nuriel Stone\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}